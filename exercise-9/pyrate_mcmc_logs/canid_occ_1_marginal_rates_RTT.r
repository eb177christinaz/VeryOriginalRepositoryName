# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.129222434181, 0.129222434181,0.129222434181,0.129222434181,0.134539355269,0.065781485019,0.0459345895365,0.0466003195985,0.0459345895365,0.0459345895365,0.0459345895365,0.0459345895365,0.0459345895365,0.0459345895365,0.0459345895365,0.0459345895365,0.0583892304023,0.065781485019,0.0632115375117,0.0647807919608,0.0632115375117,0.103063592136,0.106960926379,0.114450365077,0.114450365077,0.114450365077,0.114450365077,0.115230698299,0.114450365077,0.112756479226,0.117081791873,0.127561521864,0.120514987555,0.120514987555,0.1283672233,0.1283672233,0.123277984189,0.123277984189,0.131615021091,0.131615021091,0.121822612312,0.120514987555,0.120514987555,0.121822612312,0.120514987555,0.103300202044,0.103300202044,0.0690710608047,0.0690710608047,0.0633161697719,0.0902517012143,0.0902517012143,0.0902517012143,0.0902517012143)
L_hpd_M95=c(0.353496339029, 0.353496339029,0.353496339029,0.353496339029,0.370748792313,0.321037389525,0.277437812416,0.160585375919,0.156245318483,0.156245318483,0.156245318483,0.156245318483,0.156245318483,0.156245318483,0.156245318483,0.160585375919,0.176648338023,0.176648338023,0.176648338023,0.181225938879,0.196673894685,0.22169136808,0.22169136808,0.22169136808,0.22169136808,0.22169136808,0.22169136808,0.22169136808,0.22169136808,0.23287259573,0.297194590445,0.352979318862,0.352979318862,0.35576991513,0.369552556325,0.369552556325,0.369552556325,0.369552556325,0.376049486948,0.376049486948,0.369552556325,0.369552556325,0.369552556325,0.369552556325,0.376049486948,0.376049486948,0.376049486948,0.368903805399,0.368903805399,0.363795376056,0.392551365547,0.392551365547,0.392551365547,0.392551365547)
M_hpd_m95=c(0.812755128764, 0.812755128764,0.099183122246,0.099183122246,0.099183122246,0.099183122246,0.099183122246,0.099183122246,0.099183122246,0.099183122246,0.099183122246,0.099183122246,0.099183122246,0.099183122246,0.099183122246,0.099183122246,0.099183122246,0.099183122246,0.099183122246,0.099183122246,0.099183122246,0.099183122246,0.0956725411496,0.0610944825632,0.0440701446054,0.0381379307723,0.0404075339682,0.0375963730616,0.0375963730616,0.0356359436157,0.0375963730616,0.0375963730616,0.0375963730616,0.0375963730616,0.0375963730616,0.0375963730616,0.0375963730616,0.0375963730616,0.0375963730616,0.0375963730616,0.0375963730616,0.0375963730616,0.0375963730616,0.0375963730616,0.0375963730616,0.0375963730616,0.0375963730616,0.0375963730616,0.0375963730616,0.0375963730616,0.0375963730616,0.0375963730616,0.0375963730616,0.0375963730616)
M_hpd_M95=c(1.58334484891, 1.58334484891,0.149820080474,0.149820080474,0.148785357907,0.148785357907,0.148785357907,0.148785357907,0.148785357907,0.148785357907,0.148785357907,0.148785357907,0.148785357907,0.149820080474,0.149820080474,0.149820080474,0.149820080474,0.149820080474,0.149820080474,0.149820080474,0.149820080474,0.151174571325,0.148785357907,0.149820080474,0.142753846173,0.127614143723,0.127614143723,0.121925275101,0.117899605122,0.108152359078,0.101961518253,0.101961518253,0.101961518253,0.101961518253,0.101909895752,0.101909895752,0.101909895752,0.101909895752,0.101909895752,0.101909895752,0.101909895752,0.101909895752,0.101909895752,0.101909895752,0.101909895752,0.101909895752,0.101909895752,0.101909895752,0.101909895752,0.101909895752,0.101909895752,0.101909895752,0.101909895752,0.101909895752)
R_hpd_m95=c(-1.34576805139, -1.34576805139,0.00348637390236,0.00348637390236,-0.025798896489,-0.0588182138469,-0.0889060025715,-0.087554358358,-0.0806272229494,-0.0806272229494,-0.0806272229494,-0.0806272229494,-0.087554358358,-0.087554358358,-0.087554358358,-0.0783829739352,-0.0783829739352,-0.0631224059058,-0.0631224059058,-0.0608105244218,-0.0563791851154,-0.0236317744972,-0.0188280479309,-0.0145427452309,-0.02086083769,0.0051639517769,0.0136205225054,0.0145986125714,0.0145986125714,0.0145986125714,0.0268459787895,0.0527361116057,0.0576102447478,0.0576102447478,0.0599552952342,0.061913663331,0.0536295341707,0.0536295341707,0.0602356904668,0.0476165946435,0.0476165946435,0.0476165946435,0.0476165946435,0.0476165946435,0.0476165946435,0.0360020602198,0.0360020602198,0.00521646662774,0.00521646662774,0.0103623558275,0.0103623558275,0.0103623558275,0.0103623558275,0.0103623558275)
R_hpd_M95=c(-0.539942262371, -0.539942262371,0.253583068185,0.253583068185,0.238727923512,0.200257998397,0.164835632484,0.0503204339683,0.0503204339683,0.0503204339683,0.0503204339683,0.0503204339683,0.045391686917,0.0503204339683,0.0503204339683,0.0586238576654,0.0599552952342,0.0660963019123,0.0660963019123,0.0669357528212,0.0909838955356,0.107803733508,0.109805829927,0.109805829927,0.141297842659,0.162088279833,0.162088279833,0.161335789224,0.162088279833,0.181212118295,0.219274207046,0.300966661903,0.307311501221,0.309627414579,0.315025715521,0.315025715521,0.313913272349,0.313913272349,0.319784123508,0.308579316825,0.309627414579,0.309627414579,0.309627414579,0.309627414579,0.318072469572,0.319784123508,0.319784123508,0.309627414579,0.309627414579,0.318072469572,0.32049981636,0.32049981636,0.32049981636,0.32049981636)
L_mean=c(0.25580635319, 0.25580635319,0.25580635319,0.255674279424,0.251438680715,0.216634031025,0.115976256657,0.0926146000034,0.0916013913457,0.0916436880415,0.0916436880415,0.0915721919991,0.0915721919991,0.0916331750978,0.0918251743104,0.0965151474772,0.115863562375,0.121721922755,0.122871409602,0.12416275516,0.141684753476,0.158721148197,0.16117202334,0.162571310911,0.162571310911,0.162735749106,0.162435242894,0.162560736344,0.163449118707,0.166246574077,0.178623187046,0.21102694213,0.22672952256,0.232457673332,0.236680494331,0.238535650746,0.239229974044,0.239541681771,0.238660597934,0.236438408056,0.234992727214,0.235517753848,0.23648478647,0.236229676913,0.231716920293,0.228180748018,0.227908846492,0.224889685998,0.224889685998,0.225225315533,0.223614533837,0.223614533837,0.223614533837,0.223614533837)
M_mean=c(1.1278046607, 1.1278046607,0.129719778149,0.129719778149,0.127612338538,0.126294067049,0.126294067049,0.126294067049,0.125841652878,0.125841652878,0.125841652878,0.125841652878,0.125511237362,0.125172878258,0.125172878258,0.125172878258,0.125172878258,0.125172878258,0.125172878258,0.125172878258,0.125172878258,0.125050175648,0.12470886206,0.118791863869,0.0937610864874,0.0785539536288,0.075267070199,0.0728295116642,0.0709770849073,0.068372554632,0.0674568597365,0.0674568597365,0.0674568597365,0.0673355191071,0.0669511399525,0.0671258589812,0.0671258589812,0.0671258589812,0.0671258589812,0.0671258589812,0.0671258589812,0.0671258589812,0.0671258589812,0.0671258589812,0.0671258589812,0.0671258589812,0.0671258589812,0.0671258589812,0.0671258589812,0.0671258589812,0.0671258589812,0.0671258589812,0.0671258589812,0.0671258589812)
R_mean=c(-0.871998307511, -0.871998307511,0.126086575041,0.125954501276,0.123826342177,0.0903399639757,-0.0103178103919,-0.0336794670459,-0.0342402615328,-0.0341979648369,-0.0341979648369,-0.0342694608794,-0.0339390453632,-0.03353970316,-0.0333477039474,-0.0286577307806,-0.00930931588298,-0.00345095550285,-0.00230146865558,-0.00101012309805,0.0165118752178,0.0336709725494,0.0364631612801,0.0437794470416,0.0688102244231,0.0841817954773,0.0871681726947,0.0897312246796,0.0924720337993,0.097874019445,0.111166327309,0.143570082394,0.159272662823,0.165122154225,0.169729354378,0.171409791764,0.172104115063,0.17241582279,0.171534738953,0.169312549075,0.167866868233,0.168391894867,0.169358927489,0.169103817932,0.164591061312,0.161054889037,0.160782987511,0.157763827017,0.157763827017,0.158099456552,0.156488674856,0.156488674856,0.156488674856,0.156488674856)
trans=0.5
age=(0:(54-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.431806502101), xlim = c(-56.7,2.7), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.7416793338), xlim = c(-56.7,2.7), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.48034485653, 0.352549797996), xlim = c(-56.7,2.7), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-56.7,2.7), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()